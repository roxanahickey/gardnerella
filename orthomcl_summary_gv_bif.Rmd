---
title: "Analysis of OrthoMCL results from Gardnerella and Bifidobacterium genomes"
author: "Roxana Hickey <roxana.hickey@gmail.com>"
date: "March 20, 2015"
output: html_document
---

Load output from Gardnerella-Bifido OrthoMCL summary
```{r setup}
## Run orthomcl_summary.R with custom parameters via run_orthomcl_summary_gv_bif.R
setwd("~/Documents/research/gardnerella/gardnerella-git")
source("code/run_orthomcl_summary_gv35_bif20_id50.R") # 50% clustering, 35 GV genomes, 20 Bif genomes
source("code/run_orthomcl_summary_gv35_bif20_id70.R") # 70% clustering, 35 GV genomes, 20 Bif genomes
# source("code/run_orthomcl_summary_gv35_bif22_id70.R") # 70% clustering, 35 GV genomes, 22 Bif genomes

## Load output
load("results/orthomcl-summary-gv-bif/orthomcl_summary.RData")
```

SANDBOX
```{r sandbox}
# extract clusters only found in at least some GV, not in Bifido
bif.clade.clust <- unlist(unique(clade.clust[1:4]))
gv.clade.clust <- unlist(unique(clade.clust[5]))

# extract clusters and features found in at least 2 GV and no Bifido
gv.uniq.clust <- gv.clade.clust[!(gv.clade.clust %in% bif.clade.clust)]
gv.uniq.feat <- droplevels(subset(key.feat.cds, ortho_id %in% gv.uniq.clust))
write.table(gv.uniq.feat, "~/Documents/research/gardnerella/doc/tables/GV_uniq_clust.txt", sep="\t", row.names=F, quote=F)

# count occurences each cluster
gv.uniq.clust.count <- table(gv.uniq.feat$ortho_id)

# extract features by name found in GV but not Bifido
gv.uniq.feat.name.all <- subset(key.feat.gv, !(key.feat.gv$product %in% key.feat.bif$product))
gv.uniq.feat.name.hypo <- gv.uniq.feat.name.all[grep("hypothetical", gv.uniq.feat.name.all$product),]
write.table(gv.uniq.feat.name.hypo, "~/Documents/research/gardnerella/doc/tables/GV_uniq_feat_hypo.txt", sep="\t", row.names=F, quote=F)

gv.uniq.feat.name <- gv.uniq.feat.name.all[grep("hypothetical", gv.uniq.feat.name.all$product, invert=T),]
write.table(gv.uniq.feat.name, "~/Documents/research/gardnerella/doc/tables/GV_uniq_feat.txt", sep="\t", row.names=F, quote=F)

gv.uniq.feat.name.prod <- unique(gv.uniq.feat.name$product)
write.table(gv.uniq.feat.name, "~/Documents/research/gardnerella/doc/tables/GV_uniq_feat_product.txt", sep="\t", row.names=F, quote=F)

###
gv.core.uniq <- unlist(strsplit(unlist(ortho.clust$ortho_id[clade.core.clust.uniq$clade5]), split=" "), use.names=F)

write.table(key.fasta.gv[key.fasta.gv$cds_id %in% gv.core.uniq,], "~/Desktop/gv_uniq_core.txt", sep="\t", row.names=F, quote=F)
```